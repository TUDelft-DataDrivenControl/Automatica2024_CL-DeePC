% autosam.tex
% Annotated sample file for the preparation of LaTeX files
% for the final versions of papers submitted to or accepted for 
% publication in AUTOMATICA.

% See also the Information for Authors.

% Make sure that the zip file that you send contains all the 
% files, including the files for the figures and the bib file.

% Output produced with the elsart style file does not imitate the
% AUTOMATICA style. The style file is generic for all Elsevier
% journals and the output is laid out for easy copy editing. The
% final document is produced from the source file in the
% AUTOMATICA style at Elsevier.

% You may use the style file autart.cls to obtain a two-column 
% document (see below) that more or less imitates the printed 
% Automatica style. This may helpful to improve the formatting 
% of the equations, tables and figures, and also serves to check 
% whether the paper satisfies the length requirements.

% Please note: Authors must not create their own macros.

% For further information regarding the preparation of LaTeX files 
% for Elsevier, please refer to the "Full Instructions to Authors" 
% from Elsevier's anonymous ftp server on ftp.elsevier.nl in the
% directory pub/styles, or from the internet (CTAN sites) on
% ftp.shsu.edu, ftp.dante.de and ftp.tex.ac.uk in the directory
% tex-archive/macros/latex/contrib/supported/elsevier.


%\documentclass{elsart}               % The use of LaTeX2e is preferred.

\documentclass[twocolumn]{autart}    % Enable this line and disable the 
                                     % preceding line to obtain a two-column 
                                     % document whose style resembles the
                                     % printed Automatica style.


\usepackage{graphicx}          % Include this line if your 
                               % document contains figures,
%\usepackage[dvips]{epsfig}    % or this line, depending on which
                               % you prefer.

% ===================================================================
\input{own_preamble} % <-- add own preamble stuff
% ===================================================================

\begin{document}

\begin{frontmatter}
%\runtitle{Insert a suggested running title}  % Running title for regular 
                                              % papers but only if the title  
                                              % is over 5 words. Running title 
                                              % is not shown in output.

\title{Closed-loop Data-Enabled Predictive Control\thanksref{footnoteinfo}} % Title, preferably not more 
                                                % than 10 words.

\thanks[footnoteinfo]{This paper was not presented at any IFAC meeting.}
% \corauth[cor1]{Corresponding author.% R.~Dinkla. Tel. +XXXIX-VI-mmmxxi. Fax +XXXIX-VI-mmmxxv.
% }

\author[TUD]{R. Dinkla\corauthref{cor}}\ead{r.t.o.dinkla@tudelft.nl},    % Add the
\corauth[cor]{Corresponding author.% R.~Dinkla. Tel. +XXXIX-VI-mmmxxi. Fax +XXXIX-VI-mmmxxv.
}
\author[TUD]{S. P. Mulders}\ead{s.p.mulders@tudelft.nl},               % e-mail address 
\author[TUD,TUE]{T. Oomen}\ead{t.a.e.oomen@tudelft.nl},  % (ead) as shown
\author[TUD]{J.W. van Wingerden}\ead{j.w.vanwingerden@tudelft.nl}
\address[TUD]{Delft Center for Systems and Control, Delft University of Technology, Mekelweg 2, 2628CD Delft, The Netherlands}  % Please supply                                              
\address[TUE]{Control Systems Technology Group, Eindhoven University of Technology, 5600
MB Eindhoven, The Netherlands}        % Ful addresses here.

          
\begin{keyword}                           % Five to ten keywords,  
Data-driven predictive control; Data-enabled predictive control; closed-loop identification.               % chosen from the IFAC 
\end{keyword}                             % keyword list or with the 
                                          % help of the Automatica 
                                          % keyword wizard


\begin{abstract}%                          % Abstract of not more than 200 words.
%Large data availability and increasing system complexity have sparked interest in data-driven control methods. The aim of this paper is to reveal closed-loop identification aspects in recent approaches and develop a unified framework for closed-loop data-driven control. To this end, a Closed-loop Data-enabled Predictive Control (CL-DeePC) framework incorporates instrumental variables (IVs) to synthesize and sequentially apply consistent single or multi-step-ahead predictors. Furthermore, a computationally efficient CL-DeePC implementation is developed that reveals an equivalence with Closed-loop Subspace Predictive Control (CL-SPC). Compared to DeePC, CL-DeePC simulations demonstrate superior reference tracking, with a sensitivity study finding a 48\% lower susceptibility to noise-induced reference tracking performance degradation.
%
Factors like improved data availability and increasing system complexity have sparked interest in data-driven predictive control (DDPC) methods like Data-enabled Predictive Control (DeePC), but closed-loop identification bias in the presence of noise reduces the effectiveness of obtained control policies. In this paper we propose Closed-loop Data-enabled Predictive Control (CL-DeePC), a framework that unifies different approaches to address this challenge. To this end, CL-DeePC incorporates instrumental variables (IVs) to synthesize and sequentially apply consistent single or multi-step-ahead predictors. Furthermore, a computationally efficient CL-DeePC implementation is developed that reveals an equivalence with Closed-loop Subspace Predictive Control (CL-SPC). Compared to DeePC, CL-DeePC simulations demonstrate superior reference tracking, with a sensitivity study finding a 48\% lower susceptibility to noise-induced reference tracking performance degradation.
%
%Improved data availability and the complexity that is often associated with system modelling have sparked interest in data-driven predictive control approaches like \acf{DeePC}. Often applied adaptively, such methods then employ data obtained during closed-loop operation. Unfortunately, the use of closed-loop data results in correlation between inputs and noise, preventing the synthesis of a consistent data-driven predictor by \ac{DeePC}, thus reducing the effectiveness of obtained control policies. This paper develops a fundamental solution to this open research challenge for data-driven behavioural frameworks with \acf{CL-DeePC}. The proposed approach ensures causality of the employed predictor (unlike \ac{DeePC}) and incorporates \acf{IVs} to provide a structural means of noise mitigation. Moreover, a computationally efficient sequential implementation is presented that reduces the number of optimization variables and reveals an equivalence between \ac{CL-DeePC} and \acf{CL-SPC}. Simulations demonstrate the superior reference tracking performance of \ac{CL-DeePC} compared to \ac{DeePC}, exhibiting a 48\% lower susceptibility to noise-induced reference tracking deterioration, up to 49\% better reference tracking performance with large past data window sizes, and around 18\% better reference tracking performance with a relatively large number of data samples.
% {\color{white}
% Cum M.~Cicero consul Nonis Decembribus senatum in aede Iovis 
% Statoris consuleret, quid de iis coniurationis Catilinae sociis 
% fieri placeret, qui in custodiam traditi essent, factum est, ut 
% duae potissimum sententiae proponerentur, una D.~Silani consulis 
% designati, qui morte multandos illos censebat, altera C.~Caesaris, 
% qui illos publicatis bonis per municipia Italiae distribuendos 
% ac vinculis sempiternis tenendos existimabat.
% Cum M.~Cicero consul Nonis Decembribus senatum in aede Iovis 
% Statoris consuleret, quid de iis coniurationis Catilinae sociis 
% fieri placeret, qui in custodiam traditi essent, factum est, ut 
% duae potissimum sententiae proponerentur, una D.~Silani consulis 
% designati, qui morte multandos illos censebat, altera C.~Caesaris, 
% qui illos publicatis bonis per municipia Italiae distribuendos 
% ac vinculis sempiternis tenendos existimabat.
% Cum M.~Cicero consul Nonis Decembribus senatum in aede Iovis 
% Statoris consuleret, quid de iis coniurationis Catilinae sociis 
% fieri placeret, qui in custodiam traditi essent, factum est, ut 
% duae potissimum sententiae proponerentur, una D.~Silani consulis 
% designati, qui morte multandos illos censebat, altera C.~Caesaris, 
% qui illos publicatis bonis per municipia Italiae distribuendos 
% ac vinculis sempiternis tenendos existimabat.}
\end{abstract}

\end{frontmatter}
%===============================================================================
% define acronyms here
\begin{acronym}%
    \acro{SPC}{Subspace Predictive Control}
    \acro{CL-SPC}{Closed-loop Subspace Predictive Control}
    \acro{DeePC}{Data-enabled Predictive Control}
    \acro{LTI}{linear time-invariant}
    \acro{IV}{instrumental variable}
    \acro{IVs}{instrumental variables}
    \acro{N4SID}{Numerical algorithm for Subspace State Space System Identification}
    \acro{MPC}{Model Predictive Control}
    \acro{CL-DeePC}{Closed-loop Data-enabled Predictive Control}
    \acro{DDPC}{Data-driven Predictive Control}
\end{acronym}%
%===============================================================================
\input{docs/manuscript/sections/1_intro}
\input{docs/manuscript/sections/2_prelim}
\input{docs/manuscript/sections/3_CL_DeePC}
\input{docs/manuscript/sections/4_SolutionMethods}
\input{docs/manuscript/sections/5_EquivalenceCLSPC}
\input{docs/manuscript/sections/6_Simulation_Setup}
\input{docs/manuscript/sections/7_CL_Issue}
\input{docs/manuscript/sections/8_Sensitivity_Study}
\input{docs/manuscript/sections/9_Conclusion}

% \bibliographystyle{elsarticle-harv}%plain elsarticle-harv       % Include this if you use bibtex
% \bibliography{docs/manuscript/autosam}           % and a bib file to produce the 
                                 % bibliography (preferred). The
                                 % correct style is generated by
                                 % Elsevier at the time of printing.
\printbibliography

\appendix
% \section{A summary of Latin grammar}    % Each appendix must have a short title.
% \section{Some Latin vocabulary}         % Sections and subsections are supported  
                                        % in the appendices.
\end{document}