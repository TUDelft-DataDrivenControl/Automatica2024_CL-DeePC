\section{Equivalence to Closed-loop \acs{SPC}}
This section demonstrates an equivalence between the developed \ac{CL-DeePC} framework and \ac{CL-SPC} as developed in~\cite{Dong2008}. The \ac{CL-SPC} methodology is briefly explained first, based upon which the equivalence is demonstrated thereafter.

\subsection{Closed-loop \ac{SPC}}
To understand this equivalence, consider the data equations \eqref{eq:DataEq1} and \eqref{eq:DataEq2}. Just like \ac{CL-DeePC}, \ac{CL-SPC} uses $s=1$ to avoid closed-loop correlation between inputs and noise\footnote{Treatment of the detrimental effects thereof is reserved for a subsequent section.}, estimating the dynamic matrix $\widetilde{L}_1$ by least squares regression on past data:
\begin{align}\label{eq:CL-SPC-PredMarkov}
\hat{\widetilde{L}}_1 = \left[ \widehat{C\tKp{u}} \; \widehat{D} \; \widehat{C\tKp{y}} \right]=Y_{i_p,1,N}\mathcal{Z}^\top (\Psi_{i,1,N}\mathcal{Z}^\top)\inv,
\end{align}
in which typically, as before, $\mathcal{Z}=\Psi_{i,1,N}$. Assuming that $p$ is sufficiently large such that $\widetilde{A}^p=0$, estimates of the predictor Markov parameters contained in $\hat{\widetilde{L}}_1$ allow the construction of estimates of $\widetilde{\Gamma}_f\widetilde{K}_p^\mathrm{u}$, $\widetilde{\Gamma}_f\widetilde{K}_p^\mathrm{y}$ and $\widetilde{\mathcal{T}}_f^\mathrm{u}$ (which make up $L_f$), as well as $\tHf$. In line with \eqref{eq:DataEq2} this allows the construction of a predictor as
\begin{align}\label{eq:CL-SPC-pred1}
	\begin{split}
	\datavec{\hat{y}}{\hat{i}_p,f}&= \begin{bmatrix}\widehat{\widetilde{\Gamma}_f\tKp{u}} & \widehat{\widetilde{\mathcal{T}}_f^\mathrm{u}} \end{bmatrix} 
	\begin{bmatrix}
		\datavec{u}{\hat{i},p}\\
		\datavec{u}{\hat{i}_p,f}
	\end{bmatrix}+\\
	&\phantom{=}\mkern8mu\begin{bmatrix}
		\widehat{\widetilde{\Gamma}_f\tKp{y}} & (I_{sl}-\widehat{\widetilde{\mathcal{H}}}_f) \end{bmatrix} 
	\begin{bmatrix}
		\datavec{y}{\hat{i},p}\\
		\datavec{\hat{y}}{\hat{i}_p,f}
	\end{bmatrix}.
	\end{split}
\end{align}
Note that the predicted output is contained on both sides of this equation. To solve \eqref{eq:CL-SPC-pred1} for the predicted outputs first make note of the fact that~\citep{Houtzager2012}
\begin{align}\label{eq:MatrixRelations}
	\begin{bmatrix}
		\Gamma_f\tKp{u} & \mathcal{T}_f^\mathrm{u} & \Gamma_f\tKp{y}
	\end{bmatrix}=
        \tHf\inv\begin{bmatrix}
		\widetilde{\Gamma}_f\tKp{u} & \widetilde{\mathcal{T}}_f^\mathrm{u} & \widetilde{\Gamma}_f\tKp{y}
	\end{bmatrix},
\end{align}
as is also visible from the combination of \eqref{eq:DataEq1} and \eqref{eq:DataEq2} for $s=f$. Using estimates in \eqref{eq:MatrixRelations} to solve \eqref{eq:CL-SPC-pred1} for the output predictions (which can be done efficiently in a sequential manner as with \ac{CL-DeePC}) yields
\begin{align}\label{eq:CL-SPC-pred2}
		\datavec{\hat{y}}{\hat{i}_p,f}= \begin{bmatrix}\widehat{\Gamma_f\tKp{u}} & \widehat{\Gamma_f\tKp{y}} \end{bmatrix} 
		\begin{bmatrix}
			\datavec{u}{\hat{i},p}\\
			\datavec{y}{\hat{i},p}
		\end{bmatrix}+
		\widehat{\mathcal{T}_f^\mathrm{u}} 
		\datavec{u}{\hat{i}_p,f},
\end{align}
which is in line with \eqref{eq:DataEq1} and can be used in a receding horizon optimal control framework.

\subsection{Equivalence between \ac{CL-DeePC} and \ac{CL-SPC}}
By comparing \eqref{eq:Sequential1} to \eqref{eq:CL-SPC-pred1} for $f=1$ it can be seen that the building blocks $\tilde{\beta}_j$ and $\tilde{\theta}_j$ in \ac{CL-DeePC} are equal to the estimated predictor Markov parameters from \eqref{eq:CL-SPC-PredMarkov} that are obtained using \ac{CL-SPC}:
\begin{subequations}\label{eq:EquivMarkov}
	\begin{align}
		\tilde{\beta}_j &=
            \left\{%
            \begin{array}{ll}
			\widehat{C\tilde{A}^{p-j}\tilde{B}} &\qquad 1 \leq j \leq p,\\%\forall j\in\{\mathbb{Z}_{>0}|\;p \geq j \geq 1\}\\
			\widehat{D} &\qquad j=p+1,%\text{if } j=p+1
		\end{array}
            \right.\label{eq:EquivMarkovInputs}\\
	\tilde{\theta}_j &= \widehat{C\tilde{A}^{p-j}\tilde{B}} \mkern24mu \qquad 1 \leq j \leq p%\mkern24mu \forall j\in\{\mathbb{Z}_{>0}|\;p \geq j \geq 1\}
        \label{eq:EquivMarkovOutputs}.
	\end{align}
\end{subequations}
As a result there is an equivalence between the constructed matrices in \ac{CL-SPC} and the efficient sequential \ac{CL-DeePC} method that is succinctly described by
\begin{align}\label{eq:EquivPredictorMatrices}
	\mkern-3mu\begin{bmatrix}
		\widetilde{\mathcal{L}}^\mathrm{u}_f & \widetilde{\mathcal{G}}^\mathrm{u}_f & \widetilde{\mathcal{L}}^\mathrm{y}_f & \left(I_{fl}-\widetilde{\mathcal{G}}^\mathrm{y}_f\right)
	\end{bmatrix}\mkern-3mu=\mkern-3mu\begin{bmatrix}
		\widehat{\widetilde{\Gamma}_f\tKp{u}} & \widehat{\widetilde{\mathcal{T}}_f^\mathrm{u}} & \widehat{\widetilde{\Gamma}_f\tKp{y}} & \widehat{\widetilde{\mathcal{H}}}_f
	\end{bmatrix}\mkern-3mu.
\end{align}
It follows from \eqref{eq:Sequential3}, \eqref{eq:MatrixRelations}, and \eqref{eq:EquivPredictorMatrices} that, likewise,
\begin{align}\label{eq:EquivInnovationMatrices}
	\begin{bmatrix}
		\mathcal{L}^\mathrm{u}_f & \mathcal{G}^\mathrm{u}_f & \mathcal{L}^\mathrm{y}_f
	\end{bmatrix}=\begin{bmatrix}
		\widehat{\Gamma_f\tKp{u}} & \widehat{\mathcal{T}_f^\mathrm{u}} & \widehat{\Gamma_f\tKp{y}}
	\end{bmatrix}.
\end{align}
Moreover,~\eqref{eq:EquivInnovationMatrices} demonstrates that the output predictors~\eqref{eq:Sequential2} and~\eqref{eq:CL-SPC-pred2} of respectively \ac{CL-DeePC} and \ac{CL-SPC} are equivalent. By comparison of the sequential technique to solve \eqref{eq:Sequential3} using \eqref{eq:Sequential4} to the sequential algorithm of~\cite{Dong2008} it is furthermore possible to see that the two sequential algorithms are indeed equivalent\footnote{Note that direct-feedthrough is not considered in~\cite{Dong2008}, but that an expansion of $B=\tilde{B}+KD$ would yield an algorithm consistent with \ac{CL-DeePC} and~\eqref{eq:MatrixRelations}.}.

