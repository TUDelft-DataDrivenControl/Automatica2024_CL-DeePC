\section{Results}\label{sec:results}
\noindent This section presents simulation results of \ac{DeePC} and \ac{CL-DeePC} that facilitate the comparison of their performance, thereby providing contribution~5. We will first describe the simulation setup before presenting a reference tracking example. A subsequent demonstration of closed-loop correlation between inputs and noise is followed by a consistency analysis. Lastly, a parametric sensitivity analysis is performed.
\subsection{Simulation setup}\label{sec:simulation_setup}
\noindent This section presents the simulation setup. The simulated discrete plant is a marginally stable fifth-order 
model of the form \eqref{eqn:SS_innovation} that represents two circular plates that are spun by a motor with non-rigid shafts with \citep{Favoreel1999b}
\begin{align}\label{eq:SysFavoreel}
\scriptsize
\begin{array}{lll}
    A = \begin{bmatrix}
        4.40 & 1 & 0 & 0 & 0\\
       -8.09 & 0 & 1 & 0 & 0\\
        7.83 & 0 & 0 & 1 & 0\\
       -4.00 & 0 & 0 & 0 & 1\\
        0.86 & 0 & 0 & 0 & 0
    \end{bmatrix}\!,&
    B = \begin{bmatrix}
        0.00098\\
        0.01299\\
        0.01859\\
        0.0033\\
       -0.00002
    \end{bmatrix}\!,&C = \begin{bmatrix}
        1 \\ 0 \\ 0\\ 0\\ 0
    \end{bmatrix}^\top\mkern-7mu,\\
    K = \begin{bmatrix}
        2.3 & -6.64 & 7.515 & -4.0146 & 0.86336
    \end{bmatrix}^\top\mkern-7mu,\span
    &D=0.
\end{array}
\end{align}

Three different controllers are implemented. One controller uses \ac{DeePC} with \ac{IVs} as proposed in \cite{vanWingerden2022}\footnote{The implementation relies on an equivalent, but computationally more efficient \ac{SPC} formulation.}. Another uses \ac{CL-DeePC} with \ac{IVs}, implemented as described in \secref{sec:Sequential} to reduce computation time. As a benchmark, an oracle model predictive controller based on \eqref{eq:SS_iter} with perfect knowledge of the system matrices $\Gamma_f$, $\mathcal{T}_f^\mathrm{u}$ and state $x_{\hat{i}_p}$ is used.

All of the simulations are carried out in MATLAB\footnote{The employed code can be found on GitHub at $<$GitHub URL$>$ and the generated data sets are available on $<$Zenodo URL$>$.}, using CasADi \citep{Andersson2019} to formulate a quadratic program that is solved with IPOPT \citep{Wachter2006}. Unless indicated otherwise $p=f=20$, the employed cost function weights as in \eqref{eq:cost_fun} are $Q=100$, $R=0$, and $R^\Delta=10$, and employed constraints are $|u_k-u_{k-1}|\leq3.75$, $|u_k|\leq15$, $|y_k|<1000$. To prevent infeasibility these constraints are relaxed using quadratically penalized slack variables (with weighting $\lambda=10^{15}$) and the problem is solved again if no solution is found. This appears to be necessary with \ac{DeePC}, particularly for $\bar{N}<200$.

All simulations use a square wave reference signal that varies between 0 and 100 with a period of 200 time steps. Simulations start by data collection in open-loop with which to initialize the data-driven controllers, which are then active together with the oracle for 1800 time steps. Unless otherwise stated, the input variance for the open-loop trajectories is $\Sigma(u_k)=1$ and the innovation noise has a variance of $\Sigma(e_k)=1$ throughout.