\section{Introduction}
\noindent Trends of increasing data availability as well as increasing system complexity provide opportunities for data driven-driven control%make a compelling case for data-driven control methods as an alternative to model-based approaches
~\citep{Hou2013}. In sharp contrast to the use of data in %Whilst data can be used with
indirect data-driven approaches to synthesise a model by means of system identification, direct data-driven control approaches are promising because of their ability to derive a control law directly from data without having to realize an explicit system model as an often expensive intermediate step~\citep{Hjalmarsson2005}.

A direct data-driven control method called \acf{DeePC} is developed in~\cite{Coulson2019} and has recently attracted considerable attention. \ac{DeePC} relies on Willems' Fundamental Lemma in a receding horizon optimal control framework. This lemma reveals that for a deterministic \ac{LTI} system, any sufficiently persistently exciting input-output trajectory parameterizes all possible future input-output trajectories~\citep{Willems2005}.

% Since its conception in~\cite{Coulson2019}, a form of direct data-driven control called \ac{DeePC} has seen considerable development. \ac{DeePC} uses Willems' Fundamental Lemma from the field of behavioural systems theory, which states that for a deterministic system any sufficiently persistently exciting input-output trajectory parameterizes all possible future input-output trajectories~\cite{Willems2005}. In effect, \ac{DeePC} exploits Willems' Fundamental Lemma in a receding horizon optimal control framework found also in \ac{MPC}.
For non-deterministic systems, care has to be taken with such a parameterization in terms of only past input-output trajectories because this does not consider the effects of noise. If the block-Hankel data matrix in which the noisy input-output trajectories are stored is full rank then unattainable future trajectories may be predicted~\citep{Markovsky2022}. On the other hand, if the data matrix is rank-deficient, then the \ac{DeePC} problem may be infeasible. To deal with noise, slack variables and regularization initially served as heuristic measures to introduce robustness~\citep{Coulson2019}, but have been motivated formally to, e.g., provide robust closed-loop stability guarantees~\citep{Berberich2021}, distributional robustness~\citep{Coulson2019a}, or robustness to structured uncertainty~\citep{Huang2023}. Other approaches to handle noise include averaging techniques~\citep{Jo2022}, singular value based thresholding~\citep{Sassella2022}, and the use of maximum likelihood estimation~\citep{Yin2023}. See also~\cite{Sassella2023} for a discussion of such methods, or \cite{Verheijen2023} for a practical review of several data-driven predictive control methods.% that consider noise.

A fundamentally different noise-mitigation technique is the use of \acf{IVs}. These are employed in~\cite{vanWingerden2022} to mitigate noise and to demonstrate the equivalence between \ac{DeePC} and a subspace identification-inspired direct data-driven method called \ac{SPC} from~\cite{Favoreel1999}. This equivalence has also been demonstrated in a noiseless setting and using regularizations to deal with noise~\citep{Fiedler2021}. The established equivalence creates encouraging opportunities for in-depth analysis and further development of the direct data-driven control techniques by the strong fundamental basis of subspace identification methods. %The equivalence has many profound implications due to the connection with subspace identification, which has a strong fundamental basis.

One such a result is that in closed-loop inputs become correlated with noise, resulting in closed-loop identification bias~\citep{Soderstrom1989a}. In \cite{Dinkla2023} it is demonstrated that this problem can arise with batch-wise adaptive\footnote{In batch-wise adaptive operation, subsequent controllers employ closed-loop data from only a single controller. This paper considers (fully) adaptive implementations whereby the controller is updated at each time step.} \ac{SPC} and (given the aforementioned equivalence also) \ac{DeePC} applications, potentially degrading controller performance. Although it has been established that the closed-loop identification issue also affects \ac{DeePC}, so far this issue has only been exemplified using \ac{SPC}. Moreover, dedicated closed-loop direct data-driven control methods mostly employ a subspace paradigm, as with \acf{CL-SPC}~\citep{Dong2008}.

Two suggestions of~\cite{Dinkla2023} to tackle the closed-loop identification issue concern the use of \ac{IVs} and the use of sequential step-ahead predictions. The former suggestion motivates the parallel work of~\cite{Wang2023}, wherein the authors rely on knowledge of a non-adaptive controller to address this issue. The latter suggestion features in the concurrent work of~\cite{Shi2023} and is rigorously developed here using \ac{IVs} to mitigate noise. %
%In \citet{Wang2023} a \ac{CL-DeePC} algorithm is therefore developed that makes use of \ac{IVs} to solve this issue. Another solution to this problem is to avoid correlation between inputs and noise by using a one-step-ahead predictor~\citep{Ljung1996}. This idea is employed in~\cite{Dong2008} to develop \ac{CL-SPC}, which does not suffer from this closed-loop identification issue.
%
% To date all solutions of the closed-loop identification issue in direct data-driven predictive control applications are based on a subspace framework, as with \ac{CL-SPC}. Although the \textit{original} \ac{SPC} and \ac{DeePC} algorithms are equivalent, no behavioural approach has yet been developed that deals with closed-loop identification bias.
%The two methods that address the closed-loop issue in the behavioural framework of \ac{DeePC} either lack structural noise mitigation by means of \ac{IVs} or assume complete knowledge of a constant controller. %
To this end, the main contributions of this article are: 
%To date all solutions to deal with noise in closed-loop direct data-driven predictive control are either based on a subspace framework, as with \ac{CL-SPC}, or rely on \ac{IVs} and controller knowledge to solve this issue in \ac{DeePC}. The aim of this article is to develop a \ac{CL-DeePC} method that does not rely \ac{IVs} to solve the aforementioned closed-loop identification issue, but may use \ac{IVs} as an additional noise-mitigation technique.
%To this end, the aim of this paper is to develop a \ac{CL-DeePC}\footnote{Henceforth this abbreviation will be used to distinguish it from regular \ac{DeePC}, as developed in~\citep{Coulson2019}.} method that does not suffer from the aforementioned closed-loop identification issue.
% In doing so, the main contributions of this article are: %
\begin{enumerate}%
\item to formally establish \acf{CL-DeePC} as a new behavioural data-driven predictive control method, \label{contribution:develop_CL_DeePC}
% \item the evaluation of different possible \ac{CL-DeePC} implementations,
\item to show that \ac{CL-DeePC} solves the closed-loop identification problem that arises in the presence of feedback and noise by the sequential application of a step-ahead predictor, \label{contribution:solves_CL_issue}
\item to incorporate \ac{IVs} in \ac{CL-DeePC} as a systematic noise-mitigation technique,
\item to establish an equivalence between the developed \ac{CL-DeePC} algorithm and \ac{CL-SPC},
\item to show the superior performance of \ac{CL-DeePC} compared to \ac{DeePC} in a simulation example.
\end{enumerate}
% 
% \begin{enumerate}
%     \item implicitly enforces a causal multi-step ahead predictor model, and \label{contribution:causality}
%     \item is particularly sample-efficient (taken to mean here that it requires less past data) compared to regular \ac{DeePC}, \label{contribution:sample_efficient}
% \end{enumerate}