\section{Introduction}
Trends of increasing data availability as well as increasing system complexity make a compelling case for data-driven control methods as an alternative to model-based approaches~\cite{Hou2013}. Whilst data can be used with indirect data-driven approaches to synthesise a model by means of system identification, direct data-driven control approaches are promising because they derive a control law directly from data without having to realize an explicit system model as an (often costly) intermediate step.

Since its conception in~\cite{Coulson2019}, a form of direct data-driven control called \ac{DeePC} has seen considerable development. \ac{DeePC} uses Willems' Fundamental Lemma from the field of behavioural systems theory, which states that for a deterministic system any sufficiently persistently exciting input-output trajectory parameterizes all possible future input-output trajectories~\cite{Willems2005}. In effect, \ac{DeePC} exploits Willems' Fundamental Lemma in a receding horizon optimal control framework found also in \ac{MPC}.

For non-deterministic systems, the parameterization described by Willems' Fundamental Lemma in terms of input-output trajectories is incomplete (and thus often inconsistent) since it disregards the effects of noise. To handle noise in direct data-driven methods, several approaches have been considered in the literature, including averaging techniques~\cite{Jo2022}, singular value based thresholding~\cite{Sassella2022}, regularization~\cite{Coulson2019}, and the use of maximum likelihood estimation~\cite{Yin2023}, and \ac{IVs}~\cite{vanWingerden2022}.

Recently it has been shown that \ac{DeePC} is actually equivalent to another direct data-driven predictive control technique called \ac{SPC}, which as the name alludes to, finds its origin in the domain of subspace identification. This equivalence has been shown both in noiseless settings and those with noise that employ using regularizations~\cite{Fiedler2021} and \ac{IVs}~\cite{vanWingerden2022} as noise mitigation strategies. The aforementioned equivalence is important because it means that results from the domain of subspace identification that underpin \ac{SPC} also apply to \ac{DeePC}.

One well-known result from system identification is that in closed-loop inputs become correlated with noise, resulting in closed-loop identification bias~\cite{Soderstrom1989a}. It is demonstrated in~\cite{Dinkla2023} that this problem can arise with adaptive applications of \ac{SPC} (which inherently use closed-loop data), potentially degrading the controller performance. In addition, since \ac{SPC} and \ac{DeePC} are equivalent it is argued that these results also hold for similar adaptive \ac{DeePC} applications. To avoid correlation between inputs and noise and resulting biased subspace system identification it is possible to consider only step-ahead predictors~\cite{Ljung1996}. This idea is employed in~\cite{Dong2008} to develop \ac{CL-SPC}, which does not suffer from this closed-loop identification issue.

To the best knowledge of the authors, to date all treatment of the closed-loop identification issue that is encountered in direct data-driven predictive control applications is presented in terms of a subspace framework, perhaps because an analysis in terms of behavioural system theory is found to be less intuitive. Moreover, whilst solutions to the closed-loop identification issue in direct data-driven predictive control exist using subspace-inspired methods (like \ac{CL-SPC}), this issue has not yet been addressed by \ac{DeePC} practitioners. To this end, the main contributions of this article are:
\begin{enumerate}
\item to demonstrate a closed-loop identification issue in the presence of noise that arises with regular \ac{DeePC} (using \ac{DeePC} instead of \ac{SPC} and an equivalence argument as in~\cite{Dinkla2023}),
\item the development of two equivalent \ac{CL-DeePC} algorithms (using \ac{IVs}) that do not suffer from this closed-loop issue and are also more sample efficient,
\item to demonstrate an equivalence between the developed \ac{CL-DeePC} algorithm and \ac{CL-SPC},
\item to provide a simulation-based comparison of the attained performance of the regular and \ac{CL-DeePC} algorithms.
\end{enumerate}