\section{Introduction}
Trends of increasing data availability as well as increasing system complexity provide opportunities for data driven-driven control%make a compelling case for data-driven control methods as an alternative to model-based approaches
~\citep{Hou2013}. In sharp contrast to the use of data in %Whilst data can be used with
indirect data-driven approaches to synthesise a model by means of system identification, direct data-driven control approaches are promising because they derive a control law directly from data without having to realize an explicit system model as an often costly intermediate step.

A direct data-driven control method called \ac{DeePC} is developed in~\cite{Coulson2019} that relies on the application of Willems' Fundamental Lemma in a receding horizon optimal control framework reminiscent of \ac{MPC}. This lemma reveals that for a deterministic \ac{LTI} system, any sufficiently persistently exciting input-output trajectory parameterizes all possible future input-output trajectories~\citep{Willems2005}. %
% 
% Since its conception in~\cite{Coulson2019}, a form of direct data-driven control called \ac{DeePC} has seen considerable development. \ac{DeePC} uses Willems' Fundamental Lemma from the field of behavioural systems theory, which states that for a deterministic system any sufficiently persistently exciting input-output trajectory parameterizes all possible future input-output trajectories~\cite{Willems2005}. In effect, \ac{DeePC} exploits Willems' Fundamental Lemma in a receding horizon optimal control framework found also in \ac{MPC}.
For non-deterministic systems, this parameterization in terms of input-output trajectories does not apply directly since it disregards the effects of noise. To handle noise in direct data-driven methods, several approaches have been considered in the literature, including averaging techniques~\citep{Jo2022}, singular value based thresholding~\citep{Sassella2022}, regularization~\citep{Coulson2019}, the use of maximum likelihood estimation~\citep{Yin2023}, and \ac{IVs}~\citep{vanWingerden2022}.

In \cite{Favoreel1999} a direct data-driven approach called \ac{SPC} is developed based on a linear regression problem from subspace identification. Recently \ac{SPC} has been shown to be equivalent to \ac{DeePC} %is actually equivalent to another direct data-driven predictive control technique called \ac{SPC}, which as the name alludes to, finds its origin in the domain of subspace identification. This equivalence has been shown 
both in noiseless settings and those with noise that employ regularizations~\citep{Fiedler2021} and \ac{IVs}~\citep{vanWingerden2022} as noise mitigation strategies. The aforementioned equivalence is important because it means that results from the domain of subspace identification that underpin \ac{SPC} also apply to \ac{DeePC}.

One such a result is that in closed-loop inputs become correlated with noise, resulting in closed-loop identification bias~\citep{Soderstrom1989a}. In \cite{Dinkla2023} it is demonstrated that this problem can arise with adaptive \ac{SPC} and (given the aforementioned equivalence also) \ac{DeePC} applications, potentially degrading controller performance. %It is demonstrated in~\cite{Dinkla2023} that this problem can arise with adaptive applications of \ac{SPC} (which inherently use closed-loop data), potentially degrading the controller performance. In addition, since \ac{SPC} and \ac{DeePC} are equivalent it is argued that these results also hold for similar adaptive \ac{DeePC} applications. 
To avoid correlation between inputs and noise and resulting biased system identification it is possible to consider only step-ahead predictors~\citep{Ljung1996}. This idea is employed in~\cite{Dong2008} to develop \ac{CL-SPC}, which does not suffer from this closed-loop identification issue.

%To the best knowledge of the authors, to 
%Although a solution to the closed-loop identification problem inherent to adaptive direct data-driven control methods has been incorporated in a subspace framework by means of \ac{CL-SPC}, a \ac{DeePC} counterpart to present a solution in behavioural systems theory framework does not yet exist.
%
To date all solutions of the closed-loop identification issue in direct data-driven predictive control applications are based on a subspace framework, as with \ac{CL-SPC}. Although the \textit{original} \ac{SPC} and \ac{DeePC} algorithms are equivalent, no behavioural approach has yet been developed that deals with closed-loop identification bias. \todo{behavi-oural treatment possible?} To this end, the aim of this paper is to develop a \ac{CL-DeePC} method that does not suffer from the aforementioned closed-loop identification issue. In doing so, the main contributions of this article are: %
\begin{enumerate}%
\item the development of \ac{CL-DeePC} by sequential application of a step-ahead predictor that
\begin{enumerate}
    \item solves the closed-loop identification problem that arises in the presence of noise, \label{contribution:solves_CL_issue}
    \item implicitly enforces a causal multi-step ahead predictor model, and \label{contribution:causality}
    \item is particularly sample-efficient (taken to mean here that it requires less past data) compared to regular \ac{DeePC}, \label{contribution:sample_efficient}%particularly sample-efficient
\end{enumerate}
% \item to demonstrate a closed-loop identification issue in the presence of noise that arises with regular \ac{DeePC} (using \ac{DeePC} instead of \ac{SPC} and an equivalence argument as in~\cite{Dinkla2023}),
\item the development of \ac{CL-DeePC} (and offering different implementations) to solve the closed-loop identification problem with a sample-efficient behavioural framework,
\item the incorporation of \ac{IVs} in \ac{CL-DeePC} as a systematic noise-mitigation technique,
\item to demonstrate an equivalence between the developed \ac{CL-DeePC} algorithm and \ac{CL-SPC},
\item to provide a simulation-based comparison of the attained performance of the regular and \ac{CL-DeePC} algorithms.
\end{enumerate}